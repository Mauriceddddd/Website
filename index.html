<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>MiniWiki</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body { font-family: serif; margin:0; background:#f6f6f6; }
#header { background:#fff; padding:10px 15px; border-bottom:1px solid #a2a9b1; display:flex; justify-content:space-between; }
#container { display:flex; }
#sidebar { width:250px; padding:15px; background:#f8f9fa; border-right:1px solid #a2a9b1; }
#sidebar input, #sidebar select, #sidebar button { width:100%; margin-bottom:10px; padding:6px; }
#articleList a { display:block; color:#0645ad; margin:5px 0; cursor:pointer; }
#content { flex:1; padding:25px; background:white; }
#adminBox { position:fixed; bottom:10px; right:10px; background:white; border:1px solid #a2a9b1; padding:10px; width:180px; font-size:13px; }
</style>
</head>

<body>

<div id="header">
    <strong>MiniWiki</strong>
    <span>Maurice vergeiltes Wikipedia</span>
</div>

<div id="container">
<div id="sidebar">
    <input id="search" placeholder="Suchen..." oninput="searchArticles()">
    <select onchange="setFont(this.value)">
        <option value="serif">Wikipedia</option>
        <option value="Arial, sans-serif">Modern</option>
        <option value="monospace">Monospace</option>
    </select>
    <button id="addBtn" onclick="showEditor()" style="display:none">âž• Artikel hinzufÃ¼gen</button>
    <div id="articleList"></div>
</div>

<div id="content">
    <h2>Willkommen</h2>
    <p>MiniWiki mit Firestore Datenbank</p>
</div>
</div>

<div id="adminBox"></div>

<script>
/* FIREBASE CONFIG ERSETZEN */
const firebaseConfig = {
    apiKey: "DEIN_API_KEY",
    authDomain: "DEIN_PROJEKT.firebaseapp.com",
    projectId: "DEIN_PROJEKT"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ADMIN */
const ADMIN_USER = "Maurice";
const ADMIN_PASS = "1234";
let isAdmin = false;

/* ARTIKEL ARRAY */
let articles = [];

/* Admin Box */
function renderAdminBox(){
    adminBox.innerHTML = isAdmin ? 
    `<b>Admin</b><br><button onclick="logout()">Logout</button>` :
    `<b>Admin Login</b><br>
     <input id="adminUser" placeholder="Name">
     <input id="adminPass" type="password" placeholder="Passwort">
     <button onclick="login()">Login</button>`;
}

function login(){
    if(adminUser.value===ADMIN_USER && adminPass.value===ADMIN_PASS){
        isAdmin=true;
        renderAdminBox();
        updateAdminUI();
        alert("Admin angemeldet âœ…");
    } else alert("Falsche Daten âŒ");
}

function logout(){
    isAdmin=false;
    renderAdminBox();
    updateAdminUI();
}

/* Zeige Button nur fÃ¼r Admin */
function updateAdminUI(){
    addBtn.style.display = isAdmin ? "block" : "none";
}

/* FONT */
function setFont(font){
    document.documentElement.style.setProperty("--font-main", font);
}

/* Artikel laden (immer aktuell) */
function loadArticles(){
    db.collection("articles").onSnapshot(snapshot=>{
        articles=[];
        snapshot.forEach(doc=>{
            articles.push({id:doc.id, ...doc.data()});
        });
        renderList();
    });
}

/* Liste rendern */
function renderList(list=articles){
    articleList.innerHTML="";
    list.forEach((a,i)=>{
        articleList.innerHTML+=`<a onclick="openArticle(${i})">${a.title}</a>`;
    });
}

/* Artikel Ã¶ffnen */
function openArticle(i){
    const a=articles[i];
    content.innerHTML=`
        <h2>${a.title}</h2>
        <p>${a.text.replace(/\n/g,"<br>")}</p>
        ${isAdmin?`<button onclick="deleteArticle(${i})">ðŸ—‘ LÃ¶schen</button>`:""}
    `;
}

/* Artikel Editor */
function showEditor(){
    content.innerHTML=`
        <h2>Neuer Artikel</h2>
        <input id="title" placeholder="Titel"><br><br>
        <textarea id="text" rows="8" placeholder="Text"></textarea><br><br>
        <button onclick="saveArticle()">Speichern</button>
    `;
}

/* Artikel speichern */
function saveArticle(){
    const title=document.getElementById("title").value.trim();
    const text=document.getElementById("text").value.trim();
    if(!title||!text) return alert("Titel & Text erforderlich");
    db.collection("articles").add({title,text}).then(()=>{
        content.innerHTML="<p>Artikel gespeichert âœ…</p>";
    });
}

/* Artikel lÃ¶schen */
function deleteArticle(i){
    if(!confirm("Artikel wirklich lÃ¶schen?")) return;
    db.collection("articles").doc(articles[i].id).delete();
}

/* Suche */
function searchArticles(){
    const q=search.value.toLowerCase();
    renderList(articles.filter(a=>a.title.toLowerCase().includes(q) || a.text.toLowerCase().includes(q)));
}

/* START */
loadArticles();
renderAdminBox();
updateAdminUI();
</script>
</body>
</html>
